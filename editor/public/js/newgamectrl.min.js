/*! Ferropoly-Editor V1.104.2 02-02-2016, (c) Christian Kuster, CH-8342 Wernetshausen, christian@kusti.ch> */
"use strict";var newGameControl=angular.module("newgameApp",["ui.bootstrap","pickadate"]).config(function(pickadateI18nProvider){pickadateI18nProvider.translations={prev:'<i class="icon-chevron-left"></i> früher',next:'später <i class="icon-chevron-right"></i>'}});newGameControl.controller("newgameCtrl",["$scope","$http","$interval",function($scope,$http,$interval){$scope.map="zvv";$scope.gamename="Ferropoly Spiel";$scope.errorMessage="";$scope.gamedate=moment().add(1,"d").format("YYYY-MM-DD");$scope.minDate=moment().format("YYYY-MM-DD");$scope.random=0;$scope.maps=ferropolyMaps.maps;var authToken="none";$(document).ready(function(){$http.get("/authtoken").success(function(data){authToken=data.authToken;console.log("Auth ok")}).error(function(data,status){console.log("error:");console.log(data);console.log(status);$scope.errorMessage="Authentisierungsfehler, das Spiel kann nicht erstellt werden. Status: "+status})});$scope.validateAndSave=function(){$http.post("/gameplay/createnew",{gamename:$scope.gamename,map:$scope.map,gamedate:$scope.gamedate,random:$scope.random,authToken:authToken}).success(function(data,status){if(data.success){console.log("Game saved");self.location="/edit?gameId="+data.gameId;fa.event("Gameplay","created",data.gameId)}else{console.log("Error");console.log(data);$scope.errorMessage="Leider trat ein Fehler auf, Info:"+data.message;fa.exception("Can not create gameplay:"+data.message)}}).error(function(data,status){console.log("ERROR");console.log(data);console.log(status);$scope.errorMessage="Leider trat ein Fehler auf: Status:"+status+", Info:"+data.message;fa.exception("Can not create gameplay:"+data.message)})}}]);