var signupControl=angular.module("signupApp",["ui.bootstrap"]);signupControl.controller("signupCtrl",["$scope","$http","$interval",function(a){var b=null;a.view=0,a.email=void 0,a.forename=void 0,a.surname=void 0,a.password=void 0,a.passwordVerify=void 0,a.agbAccepted=!1,a.emailInvalid=!1,a.passwordInvalid=!1,a.passwordRepeatInvalid=!1,a.surenameInvalid=!1,a.forenameInvalid=!1,a.emailInvalidExplanation="";var c=function(a,b){a?($(b).removeClass("has-success"),$(b).addClass("has-error")):($(b).removeClass("has-error"),$(b).addClass("has-success"))},d=function(b){console.log(b),c(!b.valid,"#email-group"),b.valid?a.emailInvalid=!1:(a.emailInvalid=!0,a.emailInvalidExplanation=b.inUse?"Die Email-Adresse ist bereits in Gebrauch, eine Registrierung ist nicht möglich!":b.message?b.message:a.email&&0!==a.email.length?"Die Email-Adresse ist ungültig.":"Eine Email-Adresse ist notwendig."),a.$apply()};$(document).ready(function(){e(),b=io.connect("http://"+ferropolyServer.host+":"+ferropolyServer.port),b.on("emailVerificationResult",d),b.on("newUserSaved",function(b){console.log(b),a.view++,a.$apply()})});var e=function(){var a=$(window).height(),b=document.querySelector("#agb-box"),c=a-195;b.style.height=c.toString()+"px"};a.verifyEmail=function(){return!a.email||a.email.length<6?d({valid:!1}):void b.emit("signUpEmailVerification",{email:a.email})},a.verifyForename=function(){a.forenameInvalid=!a.forename||a.forename.length<3,c(a.forenameInvalid,"#forename-group")},a.verifySurname=function(){a.surnameInvalid=!a.surname||a.surname.length<3,c(a.surnameInvalid,"#surname-group")},a.verifyPassword=function(){a.passwordInvalid=!a.password||a.password.length<8,c(a.passwordInvalid,"#password-group")},a.verifyRepeatPassword=function(){a.passwordRepeatInvalid=!a.passwordVerify||a.password!==a.passwordVerify,c(a.passwordRepeatInvalid,"#password-repeat-group")},a.formDataValid=function(){return a.emailInvalid||a.passwordInvalid||a.passwordRepeatInvalid||a.surenameInvalid||a.forenameInvalid?!1:a.email&&a.forename&&a.surname&&a.password&&a.passwordVerify},a.createUser=function(){a.formDataValid()&&b.emit("createUser",{personalData:{forename:a.forename,surname:a.surname,email:a.email},password:a.password})}}]);